<div class="stepper-container">
  <div class="stepper-header">
    <a class="back-link" routerLink="/cart">‚Üê Back</a>
    <div class="stepper-logo">
      <a routerLink="/">
        <img src="assets/logo.png" alt="Herm√®s Paris" />
      </a>
    </div>
    <div class="spacer"></div>
  </div>
  <div class="stepper">
    <div class="step">CART</div>
    <div class="step active">CHECKOUT</div>
    <div class="step">CONFIRMATION</div>
  </div>
</div>

<!-- === LAYOUT PRINCIPAL === -->
<div class="checkout-layout">

  <!-- === COLONNE GAUCHE === -->
  <div class="checkout-left">
    <!-- ACCOUNT -->
    <section class="account-row">
      <div class="account-label">ACCOUNT</div>
      <div class="account-email">{{ email }}</div>
    </section>

    <!-- DELIVERY -->
    <section class="section-box delivery-section">
      <div class="account-label">DELIVERY</div>

      <!-- Onglets -->
      <div class="delivery-tabs">
        <div class="tab active">
          <span class="tab-icon">üöö</span>
          <span class="tab-label">Ship to an address</span>
        </div>
      </div>

      <!-- FORMULAIRE -->
      <form (ngSubmit)="submitShipping()" #shippingForm="ngForm" class="hermes-delivery-form">
        <div class="form-grid">
          <!-- Location -->
          <div class="form-cell">
            <select [(ngModel)]="selectedCountry" name="location" required>
              <option value="" disabled selected hidden>Location *</option>
              <option *ngFor="let country of countries" [value]="country.name">{{ country.name }}</option>
            </select>
          </div>

          <!-- Title -->
          <div class="form-cell">
            <select name="title" ngModel required>
              <option value="" disabled selected hidden>Title *</option>
              <option value="mr">Mr.</option>
              <option value="mrs">Mrs.</option>
            </select>
          </div>

          <!-- First Name -->
          <div class="form-cell">
            <input type="text" name="firstName" ngModel required placeholder="First name *" />
          </div>

          <!-- Last Name -->
          <div class="form-cell">
            <input type="text" name="lastName" ngModel required placeholder="Last name *" />
          </div>

          <!-- Company -->
          <div class="form-cell">
            <input type="text" name="company" ngModel placeholder="Company" />
          </div>

          <!-- Address -->
          <div class="form-cell double-width">
            <input type="text" name="address" ngModel required placeholder="Address *" />
          </div>

          <!-- Address 2 -->
          <div class="form-cell full-width">
            <input type="text" name="address2" ngModel placeholder="Address continued" />
          </div>

          <!-- City -->
          <div class="form-cell">
            <input type="text" name="city" ngModel required placeholder="City *" />
          </div>

          <!-- State -->
          <div class="form-cell">
            <input type="text" name="state" ngModel required placeholder="State *" />
          </div>

          <!-- Zip -->
          <div class="form-cell">
            <input type="text" name="zip" ngModel required placeholder="Zip code *" />
          </div>

          <!-- Zip Plus -->
          <div class="form-cell">
            <input type="text" name="zipPlus" ngModel placeholder="Zip +" />
          </div>

          <!-- Phone -->
          <div class="form-cell phone-prefix">
            <span>{{ selectedCountryCode }}</span>
            <div style="flex-grow: 1;">
              <input type="tel" name="phone" ngModel required placeholder="Telephone number *" />
            </div>
          </div>
        </div>
        <div class="form-actions">
  <button type="submit" [disabled]="isLoading">
    {{ isLoading ? 'Processing...' : 'CONFIRMER LA COMMANDE' }}
  </button>
</div>
        
      </form>
    </section>
  </div>

  <!-- === COLONNE DROITE : SUMMARY === -->
<div class="summary-card" [class.expanded]="isSummaryOpen">
  <!-- Header cliquable -->
  <div class="summary-toggle" (click)="isSummaryOpen = !isSummaryOpen">
    <span>SUMMARY</span>
    <span class="toggle-icon">{{ isSummaryOpen ? '‚ñ≤' : '‚ñº' }}</span>
  </div>

  <!-- Produits : affich√©s uniquement si ouvert -->
  <div *ngIf="isSummaryOpen" class="summary-products">
    <p class="item-count">
      You have {{ cartItems.length }} item{{ cartItems.length > 1 ? 's' : '' }} in your cart.
    </p>
    <div *ngFor="let item of cartItems" class="summary-item">
      <img [src]="item.image" alt="{{ item.name }}" />
      <div class="details">
        <div class="name">{{ item.name }}</div>
        <div class="info">Color: {{ item.color }}</div>
        <div class="info" *ngIf="item.size">Size: {{ item.size }}</div>
        <div class="info">Ref. {{ item.reference }}</div>
        <div class="quantity-control">
          <button (click)="decreaseQty(item)">-</button>
          <span>{{ item.quantity }}</span>
          <button (click)="increaseQty(item)">+</button>
        </div>
        <div class="price">{{ item.price * item.quantity | currency:'USD' }}</div>
      </div>
    </div>
  </div>

  <!-- Totaux (toujours visibles) -->
  <div class="summary-totals">
    <div class="summary-row">
      <span>SUBTOTAL</span>
      <span>{{ subtotal | currency:'USD' }}</span>
    </div>
    <div class="summary-row">
      <div>
        <span>SHIPPING</span><br />
        <small>Collect in store<br>Herm√®s Meatpacking</small>
      </div>
      <span>{{ 35 | currency:'USD' }}</span>
    </div>
    <div class="summary-row">
      <span>TAXES</span>
      <span>{{ 659.86 | currency:'USD' }}</span>
    </div>
    <div class="summary-row total-row">
      <span>TOTAL</span>
      <span>{{ subtotal + 35 + 659.86 | currency:'USD' }}</span>
    </div>
  </div>
</div>


</div>